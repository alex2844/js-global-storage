var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(b){var a=0;return function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}}};$jscomp.arrayIterator=function(b){return{next:$jscomp.arrayIteratorImpl(b)}};$jscomp.makeIterator=function(b){var a="undefined"!=typeof Symbol&&Symbol.iterator&&b[Symbol.iterator];return a?a.call(b):$jscomp.arrayIterator(b)};$jscomp.arrayFromIterator=function(b){for(var a,c=[];!(a=b.next()).done;)c.push(a.value);return c};
$jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};$jscomp.getGlobal=function(b){b=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,b];for(var a=0;a<b.length;++a){var c=b[a];if(c&&c.Math==Math)return c}return globalThis};$jscomp.global=$jscomp.getGlobal(this);$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};$jscomp.polyfill=function(b,a,c,f){if(a){c=$jscomp.global;b=b.split(".");for(f=0;f<b.length-1;f++){var d=b[f];d in c||(c[d]={});c=c[d]}b=b[b.length-1];f=c[b];a=a(f);a!=f&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};
$jscomp.polyfill("globalThis",function(b){return b||$jscomp.global},"es_next","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.SymbolClass=function(b,a){this.$jscomp$symbol$id_=b;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:a})};$jscomp.SymbolClass.prototype.toString=function(){return this.$jscomp$symbol$id_};
$jscomp.Symbol=function(){function b(c){if(this instanceof b)throw new TypeError("Symbol is not a constructor");return new $jscomp.SymbolClass($jscomp.SYMBOL_PREFIX+(c||"")+"_"+a++,c)}var a=0;return b}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("Symbol.iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.asyncIterator;b||(b=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("Symbol.asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};
$jscomp.iteratorFromArray=function(b,a){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var c=0,f={next:function(){if(c<b.length){var d=c++;return{value:a(d,b[d]),done:!1}}f.next=function(){return{done:!0,value:void 0}};return f.next()}};f[Symbol.iterator]=function(){return f};return f};$jscomp.polyfill("Array.prototype.keys",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(b){function a(){this.batch_=null}function c(a){return a instanceof d?a:new d(function(g,d){g(a)})}if(b&&!$jscomp.FORCE_POLYFILL_PROMISE)return b;a.prototype.asyncExecute=function(a){if(null==this.batch_){this.batch_=[];var g=this;this.asyncExecuteFunction(function(){g.executeBatch_()})}this.batch_.push(a)};var f=$jscomp.global.setTimeout;a.prototype.asyncExecuteFunction=function(a){f(a,0)};a.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=
this.batch_;this.batch_=[];for(var d=0;d<a.length;++d){var c=a[d];a[d]=null;try{c()}catch(m){this.asyncThrow_(m)}}}this.batch_=null};a.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var d=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var d=this.createResolveAndReject_();try{a(d.resolve,d.reject)}catch(l){d.reject(l)}};d.prototype.createResolveAndReject_=function(){function a(a){return function(g){c||(c=!0,a.call(d,g))}}var d=this,c=!1;
return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};d.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof d)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var c=null!=a;break a;case "function":c=!0;break a;default:c=!1}c?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};d.prototype.resolveToNonPromiseObj_=function(a){var d=void 0;try{d=a.then}catch(l){this.reject_(l);return}"function"==typeof d?
this.settleSameAsThenable_(d,a):this.fulfill_(a)};d.prototype.reject_=function(a){this.settle_(2,a)};d.prototype.fulfill_=function(a){this.settle_(1,a)};d.prototype.settle_=function(a,d){if(0!=this.state_)throw Error("Cannot settle("+a+", "+d+"): Promise already settled in state"+this.state_);this.state_=a;this.result_=d;this.executeOnSettledCallbacks_()};d.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=0;a<this.onSettledCallbacks_.length;++a)h.asyncExecute(this.onSettledCallbacks_[a]);
this.onSettledCallbacks_=null}};var h=new a;d.prototype.settleSameAsPromise_=function(a){var d=this.createResolveAndReject_();a.callWhenSettled_(d.resolve,d.reject)};d.prototype.settleSameAsThenable_=function(a,d){var c=this.createResolveAndReject_();try{a.call(d,c.resolve,c.reject)}catch(m){c.reject(m)}};d.prototype.then=function(a,c){function b(a,d){return"function"==typeof a?function(d){try{f(a(d))}catch(n){g(n)}}:d}var f,g,h=new d(function(a,d){f=a;g=d});this.callWhenSettled_(b(a,f),b(c,g));return h};
d.prototype.catch=function(a){return this.then(void 0,a)};d.prototype.callWhenSettled_=function(a,d){function c(){switch(b.state_){case 1:a(b.result_);break;case 2:d(b.result_);break;default:throw Error("Unexpected state: "+b.state_);}}var b=this;null==this.onSettledCallbacks_?h.asyncExecute(c):this.onSettledCallbacks_.push(c)};d.resolve=c;d.reject=function(a){return new d(function(d,c){c(a)})};d.race=function(a){return new d(function(d,b){for(var f=$jscomp.makeIterator(a),g=f.next();!g.done;g=f.next())c(g.value).callWhenSettled_(d,
b)})};d.all=function(a){var b=$jscomp.makeIterator(a),f=b.next();return f.done?c([]):new d(function(a,d){function g(d){return function(c){h[d]=c;k--;0==k&&a(h)}}var h=[],k=0;do h.push(void 0),k++,c(f.value).callWhenSettled_(g(h.length-1),d),f=b.next();while(!f.done)})};return d},"es6","es3");$jscomp.findInternal=function(b,a,c){b instanceof String&&(b=String(b));for(var f=b.length,d=0;d<f;d++){var h=b[d];if(a.call(c,h,d,b))return{i:d,v:h}}return{i:-1,v:void 0}};
$jscomp.polyfill("Array.prototype.findIndex",function(b){return b?b:function(a,c){return $jscomp.findInternal(this,a,c).i}},"es6","es3");$jscomp.owns=function(b,a){return Object.prototype.hasOwnProperty.call(b,a)};$jscomp.assign="function"==typeof Object.assign?Object.assign:function(b,a){for(var c=1;c<arguments.length;c++){var f=arguments[c];if(f)for(var d in f)$jscomp.owns(f,d)&&(b[d]=f[d])}return b};$jscomp.polyfill("Object.assign",function(b){return b||$jscomp.assign},"es6","es3");
(function(){var b=function(a){var c=this,b=this;Object.defineProperty(this,"#storageAvailable",{value:function(){try{var a=window.localStorage;a.setItem("__storage_test__","__storage_test__");a.removeItem("__storage_test__");return!0}catch(g){return!1}}(),enumerable:!1});if(a&&(a.url&&-1<a.url.indexOf("//docs.google.com/spreadsheets/d/")&&(a.spreadsheet=a.url.split("/d/")[1].split("/")[0],delete a.url),a.spreadsheet)){if(!a.proxy&&-1<navigator.userAgent.indexOf("/bot"))a.proxy="https://proxy.fetchcors.workers.dev/";
else if(!document.querySelector('link[href="https://spreadsheets.google.com"]')){var d=document.createElement("link");d.rel="preconnect";d.href="https://spreadsheets.google.com";document.getElementsByTagName("head")[0].appendChild(d)}Object.defineProperty(this,"#cache",{value:new Proxy({},{get:function(a,d){return(b["#storageAvailable"]&&localStorage.sheetStorageCache?JSON.parse(localStorage.sheetStorageCache):{})[d]},set:function(a,d,c){b["#storageAvailable"]&&(a=localStorage.sheetStorageCache?JSON.parse(localStorage.sheetStorageCache):
{},a[d]={time:Math.round((new Date).getTime()/1E3),body:c},localStorage.sheetStorageCache=JSON.stringify(a));return!0}}),enumerable:!1})}Object.defineProperty(this,"#opts",{value:a||null,enumerable:!1});!("BroadcastChannel"in window)||this["#opts"]&&this["#opts"].spreadsheet||(Object.defineProperty(this,"#broadcast",{value:new BroadcastChannel("globalStorageBroadcast:"+this.hash(this["#opts"])),enumerable:!1}),this["#broadcast"].addEventListener("message",function(a){c["#opts"].providers&&(a.data.cron?
(c["#timers"].cron&&clearTimeout(c["#timers"].cron),c["#timers"].multitabs&&clearTimeout(c["#timers"].multitabs),c["#timers"].multitabs=setTimeout(function(){return c.cron()},6E5)):(c["#data"]=JSON.parse(localStorage.getItem("syncStorageCache"+(c["#opts"].prefix?"_"+c["#opts"].prefix:""))),c.reload()));window.dispatchEvent(c.globalStorageEvent(a.data))}));return this.reload(!0)};b.prototype.globalStorageEvent=function(a){return Object.defineProperties(new CustomEvent(a.type),{id:{value:this["#broadcast"].name,
enumerable:!0},key:{value:a.key||null,enumerable:!0},oldValue:{value:a.oldValue||null,enumerable:!0},newValue:{value:a.newValue||null,enumerable:!0},url:{value:a.url||null,enumerable:!0},path:{value:a.path||[],enumerable:!0},storageArea:{value:this,enumerable:!0}})};b.prototype.reload=function(a){var c=this;a||Object.keys(this).forEach(function(a){return delete c[a]});if(this["#opts"]){if(this["#opts"].spreadsheet)return(this["#opts"].lists||this["#cache"][this["#opts"].spreadsheet]&&3600>Math.round((new Date).getTime()/
1E3)-this["#cache"][this["#opts"].spreadsheet].time&&(this["#opts"].lists=this["#cache"][this["#opts"].spreadsheet].body)?Promise.resolve(this["#opts"].lists):fetch((this["#opts"].proxy||"")+"https://spreadsheets.google.com/feeds/worksheets/"+this["#opts"].spreadsheet+"/public/basic?alt=json").then(function(a){return a.json().then(function(a){return c["#cache"][c["#opts"].spreadsheet]=a.feed.entry.map(function(a){return{id:a.id.$t.split("/").slice(-1)[0],title:a.content.$t,time:Math.round((new Date(a.updated.$t)).getTime()/
1E3)}})})})).then(function(a){a.forEach(function(a){return Object.defineProperty(c,a.title,{enumerable:!0,get:function(){return this.fetchList(a.id)}})});var d=Object.getOwnPropertyNames(c.__proto__).concat(["then"]);return new Proxy(c,{get:function(a,c){return-1!=d.indexOf(c)||a.hasOwnProperty(c)?a[c]:Promise.reject()}})});if(this["#opts"].providers){if(a){var f="syncStorageCache"+(this["#opts"].prefix?"_"+this["#opts"].prefix:"");Object.defineProperties(this,{"#timers":{value:{},enumerable:!1,writable:!0,
configurable:!0},"#data":{value:localStorage.getItem(f)?JSON.parse(localStorage.getItem(f)):[b.merge(b.default(this["#opts"].default))],enumerable:!1,writable:!0,configurable:!0}});return this.auth(null)}console.log("reload");a=b.merge.apply(b,$jscomp.arrayFromIterable(this["#data"].map(function(a){return a.config})));for(f in a)Object.defineProperty(this,f,{value:a[f],enumerable:!0,writable:!0,configurable:!0})}else this["#opts"].cookie&&document.cookie.split("; ").filter(function(a){return a}).forEach(function(a){return c[a.split("=")[0]]=
a.split("=").slice(1).join("=")})}return this.__isProxy?this:new Proxy(this,{set:function(a,b,f){console.log("SET",{obj:a,key:b,val:f});c.save(b,a[b],a[b]=f);return!0},get:function(a,c){return"__isProxy"!==c?a[c]:!0}})};b.prototype.users=function(){return this["#data"].map(function(a){return a.user}).filter(function(a){return a})};b.prototype.users_add=function(a,c,f,d){var h=this;console.log("add",{user:a});if(this.users().length)console.log("adding 2 user");else{if(a){var g=this.users();-1<(g=g.length?
g.findIndex(function(c){return c.id==a.id}):0)?(this["#data"][g].user=a,c&&(this["#data"][g].token=c)):g=this["#data"].push(b.merge(b.default(this["#opts"].default),{user:a,token:c||{}}))-1;console.log("USER",a,g);return f(this.fetchFind())}"corsProxy"in window&&corsProxy&&"gapi"in corsProxy?corsProxy.gapi().then(function(a){a.time=Math.round((new Date).getTime()/1E3);gapi.client.setToken({access_token:a.access_token});return gapi.client.request({path:"https://people.googleapis.com/v1/people/me",
params:{personFields:"emailAddresses,names,photos"}}).then(function(c){return h.users_add({id:c.result.emailAddresses[0].value,name:c.result.names[0].displayName,iconURL:c.result.photos[0].url,provider:"https://accounts.google.com"},a,f,d)},function(a){return d(a)})}):gapi.client.request({path:"https://people.googleapis.com/v1/people/me",params:{personFields:"emailAddresses,names,photos"}}).then(function(a){a={id:a.result.emailAddresses[0].value,name:a.result.names[0].displayName,iconURL:a.result.photos[0].url,
provider:"https://accounts.google.com"};window.PasswordCredential&&navigator.credentials.store(new FederatedCredential(a));return h.users_add(a,null,f,d)},function(a){return d(a)})}};b.prototype.gapi=function(){return new Promise(function(a,c){if("gapi"in window)return gapi.load("client",function(){return a()});var b=document.createElement("script");b.src="https://apis.google.com/js/api.js";b.addEventListener("load",function(){return gapi.load("client",function(){if("corsProxy"in window&&corsProxy&&
"async"in corsProxy&&"gapiAsync"in corsProxy)a();else{var d=document.createElement("script");d.src="https://accounts.google.com/gsi/client";d.addEventListener("load",function(){return a()});d.addEventListener("error",function(a){return c(a)});document.body.appendChild(d)}})});b.addEventListener("error",function(a){return c(a)});document.body.appendChild(b)})};b.prototype.auth=function(a,c,b){var d=this;return c&&b?gapi.client.init({}).then(function(){if("corsProxy"in window&&corsProxy&&"async"in corsProxy&&
"gapiAsync"in corsProxy)corsProxy.gapi=function(){return corsProxy.async("gapiAsync",{client_id:d["#opts"].providers.google.id,scope:"openid profile email https://www.googleapis.com/auth/drive.appfolder https://www.googleapis.com/auth/user.emails.read https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile"}).then(function(a){return JSON.parse(a)})};else return(new Promise(function(a){var c=Math.round((new Date).getTime()/1E3);if(d["#data"][0].token.access_token&&
d["#data"][0].token.time+d["#data"][0].token.expires_in>c+30)return gapi.client.setToken({access_token:d["#data"][0].token.access_token}),a(d["#data"][0].token.access_token);google.accounts.oauth2.initTokenClient({client_id:d["#opts"].providers.google.id,scope:"openid profile email https://www.googleapis.com/auth/drive.appfolder https://www.googleapis.com/auth/user.emails.read https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile",callback:function(c){d["#data"][0].token=
c;d["#data"][0].token.time=Math.round((new Date).getTime()/1E3);return a(d["#data"][0].token.access_token)}}).requestAccessToken()})).then(function(){a?(console.log("init",{id:a}),gapi.client.request({path:"https://people.googleapis.com/v1/people/me",params:{personFields:"emailAddresses,names,photos"}}).then(function(a){return d.users_add({id:a.result.emailAddresses[0].value,name:a.result.names[0].displayName,iconURL:a.result.photos[0].url,provider:"https://accounts.google.com"},null,c,b)},function(a){return b(a)})):
d.users().length?c():d.users_add(null,null,c,b)})},function(a){b(a)}):(new Promise(function(c,b){d.users().length||null!==a?d.gapi().then(function(){return d.auth(a,c,b)}):null===a?d.credentials("silent").then(function(a){return a?d.auth(a).then(function(){return c()}).catch(function(a){return b(a)}):c(null)}):c(null)})).then(function(a){return null!==a?d.cron():d.reload()})};b.prototype.cron=function(){var a=this,c=Math.round((new Date).getTime()/1E3);if(this["#data"][0].token.access_token)if(this["#data"][0].token.time+
this["#data"][0].token.expires_in>c+30)gapi.client.setToken({access_token:this["#data"][0].token.access_token});else if("corsProxy"in window&&corsProxy&&"gapi"in corsProxy)return corsProxy.gapi().then(function(c){c.time=Math.round((new Date).getTime()/1E3);gapi.client.setToken({access_token:c.access_token});return a.cron(a["#data"][0].token=c)});return new Promise(function(f,d){a["#broadcast"].postMessage({cron:!0});a["#timers"].cron&&clearTimeout(a["#timers"].cron);var h=300<c-a["#data"][0].time?
0:3E5;h&&(console.log("skip wait cron",h),f(a.reload()));a["#timers"].cron=setTimeout(function(){console.log("Starting periodic sources sync: "+h);var c=a.hash(a["#data"][0].config);a.fetchConfigLoad().then(function(){var d=a.reload();h&&c!=a.hash(a["#data"][0].config)&&window.dispatchEvent(a.globalStorageEvent({url:location.href,type:"storage"}));return a.cron(f(d))}).catch(function(c){a["#data"][0]=b.default(a["#data"][0].config);a.save();d(c)})},h)})};b.prototype.credentials=function(a){return!window.PasswordCredential||
!window.PublicKeyCredential||navigator.webdriver||!window.chrome||-1<navigator.userAgent.indexOf("/bots")?Promise.resolve(null):navigator.credentials.get({federated:{providers:["https://accounts.google.com"]},mediation:a}).then(function(a){if(!a)return null;switch(a.type){case "federated":switch(a.provider){case "https://accounts.google.com":return a.id}}})};b.prototype.fetchFind=function(a){var c=this,b="syncStorage"+(this["#opts"].prefix?"_"+this["#opts"].prefix:"");return new Promise(function(d,
f){if(c["#data"][0].id)return d();console.log("Finded remote file");gapi.client.request({path:"/drive/v3/files",params:{spaces:"appDataFolder",fields:"files(id, name)",pageSize:500,q:"name = '"+b+"_config.json'",orderBy:"createdTime"}}).then(function(g){g.result.files.length?(console.log("find file",g.result.files),d(c.fetchConfigLoad(a,c["#data"][0].id=g.result.files[0].id))):gapi.client.request({path:"/drive/v3/files/",method:"POST",body:{name:b+"_config.json",mimeType:"application/json",parents:["appDataFolder"]}}).then(function(a){console.log("create file",
a.result);d(c["#data"][0].id=a.result.id)},function(a){return f(a)})},function(a){return f(a)})})};b.prototype.fetchConfigLoad=function(a,c){var f=this;return new Promise(function(d,h){if(!f["#data"][0].id)return d();console.log("fetchConfigLoad");gapi.client.request({path:"/drive/v3/files/"+f["#data"][0].id,params:{alt:"media"}}).then(function(a){a.result?(console.log("BODY",f["#data"][0].config,a.result),f["#data"][0].config=c?b.merge(f["#data"][0].config,a.result):Object.assign(f["#data"][0].config,
a.result)):console.log("BODY",a);f["#timers"].hash=f.hash(f["#data"][0].config);f.save();return d()},function(c){console.log("error fetchConfigLoad");a?h(e):d(f.fetchFind(!0,f["#data"][0].id=null))})})};b.prototype.fetchList=function(a){var c=this;return(this["#cache"][this["#opts"].spreadsheet+"/"+a]&&3600>Math.round((new Date).getTime()/1E3)-this["#cache"][this["#opts"].spreadsheet+"/"+a].time?Promise.resolve(this["#cache"][this["#opts"].spreadsheet+"/"+a].body):fetch((this["#opts"].proxy||"")+
"https://spreadsheets.google.com/feeds/cells/"+this["#opts"].spreadsheet+"/"+(a||"od6")+"/public/values?alt=json",{signal:this["#opts"].signal}).then(function(b){return b.json().then(function(d){return c["#cache"][c["#opts"].spreadsheet+"/"+a]=d.feed.entry?d.feed.entry.reduce(function(a,c){for(;a.length<c.gs$cell.row;)a.push([]);for(var d=a[a.length-1];d.length+1<c.gs$cell.col;)d.push("");d.push(c.content.$t);return a},[]):[]})})).then(function(a){return Object.defineProperties({},{cells:{value:a,
enumerable:!0},json:{enumerable:!0,get:function(){return a.slice(1).reduce(function(c,b){c.push(b.reduce(function(c,d,b){c[a[0][b]]=d;return c},{}));return c},[])}}})})};b.prototype.hash=function(a){return("string"==typeof a?a:JSON.stringify(a)).split("").reduce(function(a,b){a=(a<<5)-a+b.charCodeAt(0);return a&a},0)};b.prototype.getItem=function(a){var c=this,b="path"in this?this.path[0]:this;if(b["#opts"]&&b["#opts"].spreadsheet)return this[a];if(b["#opts"]&&b["#opts"].providers&&"object"==typeof this[a]){var d=
this.path||[this];d.push(this[a]);Object.defineProperties(this[a],{id:{value:a,enumerable:!1},path:{value:d,enumerable:!1,writable:!0,configurable:!0}});Object.getOwnPropertyNames(b.__proto__).forEach(function(d){return Object.defineProperty(c[a],d,{value:b.__proto__[d],enumerable:!1})});return this[a]}return this.hasOwnProperty(a)?String(this[a]):null};b.prototype.setItem=function(a,c){var b="path"in this?this.path[0]:this;if(b["#opts"])if(b["#opts"].cookie)b=new Date,b.setTime(b.getTime()+864E5),
document.cookie=a+"="+c+";path=/;expires="+b.toUTCString();else if(b["#opts"].providers){var d=this[a];this[a]=c;var h={},g;for(g in b["#data"])h.$jscomp$loop$prop$d$3=b["#data"][g].config,"path"in this&&this.path.slice(1).forEach(function(a){return function(c){return a.$jscomp$loop$prop$d$3=a.$jscomp$loop$prop$d$3[c.id]}}(h)),h.$jscomp$loop$prop$d$3[a]=c,h={$jscomp$loop$prop$d$3:h.$jscomp$loop$prop$d$3};"path"in this&&b.save(a,d,c,this.path);return}this[a]=void 0===c?null:String(c)};b.prototype.removeItem=
function(a){var c="path"in this?this.path[0]:this;if(c["#opts"])if(c["#opts"].cookie)document.cookie=a+"=;path=/;expires=Thu, 01 Jan 1970 00:00:01 GMT;";else if(c["#opts"].providers){var b=this[a];this[a]=void 0;delete this[a];var d={},h;for(h in c["#data"])d.$jscomp$loop$prop$d$5=c["#data"][h].config,"path"in this&&this.path.slice(1).forEach(function(a){return function(c){return a.$jscomp$loop$prop$d$5=a.$jscomp$loop$prop$d$5[c.id]}}(d)),d.$jscomp$loop$prop$d$5[a]=void 0,delete d.$jscomp$loop$prop$d$5[a],
d={$jscomp$loop$prop$d$5:d.$jscomp$loop$prop$d$5};"path"in this&&c.save(a,b,void 0,this.path);return}this[a]=void 0;delete this[a]};b.prototype.clear=function(){var a=this;Object.keys(this).forEach(function(c){return delete a[c]});this.save()};b.prototype.key=function(a){if(void 0==a)throw new TypeError("Failed to execute 'key' on 'Storage': 1 argument required, but only 0 present.");return Object.keys(this)[a]};b.prototype.save=function(a,c,b,d){var f=this;if(!a||c!==b){!this["#opts"].providers&&
"BroadcastChannel"in window&&this["#broadcast"].postMessage({key:a,oldValue:c,newValue:b,path:d?d.slice(1).map(function(a){return a.id}):[],url:location.href,type:"storage"});console.log("SAVE",this);var g="path"in this?this.path[0]:this;if(g["#opts"]&&g["#opts"].providers){for(var k in g["#data"])g["#data"][k].time=Math.round((new Date).getTime()/1E3);g["#timers"].save&&clearTimeout(g["#timers"].save);g["#timers"].save=setTimeout(function(){localStorage.setItem("syncStorageCache"+(g["#opts"].prefix?
"_"+g["#opts"].prefix:""),JSON.stringify(g["#data"]));f["#opts"].providers&&"BroadcastChannel"in window&&f["#broadcast"].postMessage({key:a,oldValue:c,newValue:b,path:d?d.slice(1).map(function(a){return a.id}):[],url:location.href,type:"storage"});g["#timers"].sync&&clearTimeout(g["#timers"].sync);var h=g.hash(g["#data"][0].config);g["#timers"].hash==h&&console.log("hash == hash");"gapi"in window&&g["#data"][0].token.access_token&&g["#timers"].hash!=h&&(g["#timers"].hash=h,g["#timers"].sync=setTimeout(function(){g["#data"].forEach(function(a){console.log("sync",
a.config);gapi.client.request({path:"/upload/drive/v3/files/"+a.id,method:"PATCH",params:{uploadType:"media"},body:"string"==typeof a.config?a.config:JSON.stringify(a.config)}).then(function(){},function(a){return console.log("error sync",a)})});delete g["#timers"].sync},2250));delete g["#timers"].save},250)}}};b.default=function(a){return{id:null,time:null,user:null,token:{},config:a||{welcome:!1}}};b.merge=function(){for(var a,c,b={},d=[].splice.call(arguments,0);0<d.length;)if("[object Object]"==
toString.call(a=d.splice(0,1)[0]))for(c in a)a.hasOwnProperty(c)&&("[object Object]"==toString.call(a[c])?b[c]=this.merge(b[c]||{},a[c]):b[c]&&"[object Array]"==toString.call(a[c])?0<Object.keys(a[c]).length&&(b[c]=a[c].concat(b[c])):b[c]=a[c]);return b};b.init=function(){window.globalStorage=this;"sessionStorage"in window||(window.sessionStorage=new this);"localStorage"in window||(window.localStorage=new this);window.cookieStorage=new this({cookie:!0})};$jscomp.global.Object.defineProperties(b.prototype,
{length:{configurable:!0,enumerable:!0,get:function(){return Object.keys(this).length}}});b.init()})();